<!DOCTYPE html>
<a href="{{ url_for('risk_select') }}" class="{{ 'active' if request.endpoint=='risk_select' }}">Risklerim</a>
<a href="{{ url_for('categories_index') }}" class="{{ 'active' if request.endpoint=='categories_index' }}">Kategoriler</a>
<a href="{{ url_for('schedule') }}" class="{{ 'active' if request.endpoint=='schedule' }}">Zaman Ã‡izelgesi</a>
<a href="{{ url_for('reports') }}" class="{{ 'active' if request.endpoint=='reports' }}">Raporlar</a>
{% if session.get('role') == 'admin' %}
<a href="{{ url_for('import_suggestions') }}" class="{{ 'active' if request.endpoint=='import_suggestions' }}">Risk ve Kategori Aktarma (CSV,Excel)</a>
{% endif %}
<a href="{{ url_for('responsibles') }}" class="{{ 'active' if request.endpoint=='responsibles' }}">Sorumlu Ã–zeti</a>
<!-- XLSX dÄ±ÅŸa aktar -->
<a href="{{ url_for('risks_export_xlsx', title='DENÄ°Z YAPILARI Ä°NÅžAAT PROJESÄ° RÄ°SK ANALÄ°ZÄ°') }}">Excel (BiÃ§imli) DÄ±ÅŸa Aktar</a>
</div>
</div>


<div class="menu-section">
<h4>Ayarlar</h4>
<div class="submenu">
{% if session.get('role') == 'admin' %}
<a href="{{ url_for('admin_users') }}" class="{{ 'active' if request.endpoint=='admin_users' }}">KullanÄ±cÄ± YÃ¶netimi</a>
{% endif %}
<a href="{{ url_for('settings_account') }}" class="{{ 'active' if request.endpoint=='settings_account' }}">Hesap Bilgileri</a>
<a href="{{ url_for('settings_project') }}" class="{{ 'active' if request.endpoint=='settings_project' }}">Proje Bilgileri</a>
</div>
</div>


<div class="menu-section">
<h4>Hesap</h4>
{% if session.get('username') %}
<div class="small" style="padding:.25rem 1.25rem .5rem">
ðŸ‘‹ {{ session.get('username') }}{% if session.get('role') %} Â· {{ session.get('role')|capitalize }}{% endif %}
</div>
{% endif %}
<a href="{{ url_for('logout') }}">Oturumu Kapat</a>
</div>
</aside>


<!-- Main -->
<main class="main">
{% with messages = get_flashed_messages(with_categories=true) %}
{% if messages %}
{% for cat, msg in messages %}
<div class="flash {{cat}}">{{ msg }}</div>
{% endfor %}
{% endif %}
{% endwith %}


{% block content %}{% endblock %}


<footer class="small" style="margin-top:24px;opacity:.8">Â© {{ 2025 }} RiskApp</footer>
</main>


</div>


<!-- Tema toggle + panel auto-mark -->
<script>
(function(){
const KEY = 'riskapp.theme';
const root = document.documentElement;
const btn = () => document.getElementById('themeToggle');


function applyTheme(t){
root.setAttribute('data-theme', t);
try{ localStorage.setItem(KEY, t); }catch(e){}
if (btn()){
btn().textContent = (t === 'light') ? 'ðŸŒ™ Koyu Tema' : 'ðŸŒž AÃ§Ä±k Tema';
}
}


const saved = (()=>{ try{ return localStorage.getItem(KEY); }catch(e){ return null; } })();
const prefersDark = window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches;
const initial = saved || (prefersDark ? 'dark' : 'light');
applyTheme(initial);


window.__toggleTheme = function(){
const current = root.getAttribute('data-theme') || 'light';
applyTheme(current === 'light' ? 'dark' : 'light');
};


// DeÄŸerlendirme / RPN panellerini koyu temada auto-mark (beyaz fix)
function markAssessmentsPanel(){
const candidates = document.querySelectorAll('.card, .panel, .section, .box, .content, .container');
candidates.forEach(el => {
const titleEl = el.querySelector('h1, h2, h3, .title, .header');
if (!titleEl) return;
const t = (titleEl.textContent || '').trim().toLowerCase();
if (t.startsWith('deÄŸerlendirmeler') || t === 'rpn' || t.includes('p / s / d')){
el.classList.add('assessments');
}
});
}
if (document.readyState === 'loading'){
document.addEventListener('DOMContentLoaded', markAssessmentsPanel);
} else {
markAssessmentsPanel();
}
})();
</script>


{% block scripts %}{% endblock %}
</body>
</html>